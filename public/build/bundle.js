(()=>{"use strict";(()=>{new Set;const t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class e{_listeners="WeakMap"in t?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((t=>{for(const i of t)e.entries.set(i.target,i),this._listeners.get(i.target)?.(i)})))}}e.entries="WeakMap"in t?new WeakMap:void 0;let i,s,n=!1;function r(t,e){t.appendChild(e)}function o(t,e,i){t.insertBefore(e,i||null)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function l(){return function(t){return document.createTextNode(t)}(" ")}function c(t,e,i,s){return t.addEventListener(e,i,s),()=>t.removeEventListener(e,i,s)}function d(t,e,i){null==i?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function u(){}function m(t){return t()}function g(){return Object.create(null)}function f(t){t.forEach(m)}function p(t){return"function"==typeof t}function y(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function $(t,e){return t===e||(i||(i=document.createElement("a")),i.href=e,t===i.href)}function x(t){return null==t?"":t}function w(t){s=t}new Map;const v=[],b=[];let P=[];const C=[],_=Promise.resolve();let M=!1;function k(t){P.push(t)}const T=new Set;let B=0;function E(){if(0!==B)return;const t=s;do{try{for(;B<v.length;){const t=v[B];B++,w(t),S(t.$$)}}catch(t){throw v.length=0,B=0,t}for(w(null),v.length=0,B=0;b.length;)b.pop()();for(let t=0;t<P.length;t+=1){const e=P[t];T.has(e)||(T.add(e),e())}P.length=0}while(v.length);for(;C.length;)C.pop()();M=!1,T.clear(),w(t)}function S(t){if(null!==t.fragment){t.update(),f(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(k)}}const L=new Set;let D;function R(t,e,i,r,o,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[-1];const d=s;w(t);const y=t.$$={fragment:null,ctx:[],props:a,update:u,not_equal:o,bound:g(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:g(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};l&&l(y.root);let $=!1;if(y.ctx=i?i(t,e.props||{},(function(e,i){const s=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:i;return y.ctx&&o(y.ctx[e],y.ctx[e]=s)&&(!y.skip_bound&&y.bound[e]&&y.bound[e](s),$&&function(t,e){-1===t.$$.dirty[0]&&(v.push(t),M||(M=!0,_.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),i})):[],y.update(),$=!0,f(y.before_update),y.fragment=!!r&&r(y.ctx),e.target){if(e.hydrate){n=!0;const t=(b=e.target,Array.from(b.childNodes));y.fragment&&y.fragment.l(t),t.forEach(h)}else y.fragment&&y.fragment.c();e.intro&&(x=t.$$.fragment)&&x.i&&(L.delete(x),x.i(undefined)),function(t,e,i){const{fragment:s,after_update:n}=t.$$;s&&s.m(e,i),k((()=>{const e=t.$$.on_mount.map(m).filter(p);t.$$.on_destroy?t.$$.on_destroy.push(...e):f(e),t.$$.on_mount=[]})),n.forEach(k)}(t,e.target,e.anchor),n=!1,E()}var x,b;w(d)}function Z(t,e,i,s){const n=i[t]?.type;if(e="Boolean"===n&&"boolean"!=typeof e?null!=e:e,!s||!i[t])return e;if("toAttribute"===s)switch(n){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(n){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(D=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,i){super(),this.$$ctor=t,this.$$s=e,i&&this.attachShadow({mode:"open"})}addEventListener(t,e,i){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const i=this.$$c.$on(t,e);this.$$l_u.set(e,i)}super.addEventListener(t,e,i)}removeEventListener(t,e,i){if(super.removeEventListener(t,e,i),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=a("slot"),"default"!==t&&d(e,"name",t)},m:function(t,i){o(t,e,i)},d:function(t){t&&h(e)}}}}const e={},i=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const n of this.$$s)n in i&&(e[n]=[t(n)]);for(const r of this.attributes){const l=this.$$g_p(r.name);l in this.$$d||(this.$$d[l]=Z(l,r.value,this.$$p_d,"toProp"))}for(const c in this.$$p_d)c in this.$$d||void 0===this[c]||(this.$$d[c]=this[c],delete this[c]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const s=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=Z(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(s),s();for(const u in this.$$l)for(const m of this.$$l[u]){const g=this.$$c.$on(u,m);this.$$l_u.set(m,g)}this.$$l={}}}attributeChangedCallback(t,e,i){this.$$r||(t=this.$$g_p(t),this.$$d[t]=Z(t,i,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class A{$$=void 0;$$set=void 0;$destroy(){(function(t,e){const i=t.$$;null!==i.fragment&&(function(t){const e=[],i=[];P.forEach((s=>-1===t.indexOf(s)?e.push(s):i.push(s))),i.forEach((t=>t())),P=e}(i.after_update),f(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])})(this,1),this.$destroy=u}$on(t,e){if(!p(e))return u;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");let H={rectangles:{shades:[],teeth:[]},currentDraw:"",showHint:!1,imageSelected:!1};function z(t){const[e,i,s]=t.map((t=>t/255)),n=Math.max(e,i,s),r=Math.min(e,i,s);let o,h,a=(n+r)/2;if(n===r)o=h=0;else{const t=n-r;switch(h=a>.5?t/(2-n-r):t/(n+r),n){case e:o=(i-s)/t+(i<s?6:0);break;case i:o=(s-e)/t+2;break;case s:o=(e-i)/t+4;break;default:o=0}o/=6}return[o,h,a]}function I(t){const e=t=>(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);let i=e(t[0]),s=e(t[1]),n=e(t[2]);const r=[[.4124564,.3575761,.1804375],[.2126729,.7151522,.072175],[.0193339,.119192,.9503041]];let o=r[0][0]*i+r[0][1]*s+r[0][2]*n,h=r[1][0]*i+r[1][1]*s+r[1][2]*n,a=r[2][0]*i+r[2][1]*s+r[2][2]*n;o=Math.max(0,Math.min(o,.95047)),h=Math.max(0,Math.min(h,1)),a=Math.max(0,Math.min(a,1.08883));const l=.008856,c=903.3,d=h>l?Math.pow(h,1/3):(c*h+16)/116;return[116*d-16,500*((o>l?Math.pow(o,1/3):(c*o+16)/116)-d),200*(d-(a>l?Math.pow(a,1/3):(c*a+16)/116))]}window.data=H;class O{color1;color2;weights;ksubL;ksubC;ksubH;deltaLPrime;LBar;C1;C2;CBar;aPrime1;aPrime2;CPrime1;CPrime2;CBarPrime;deltaCPrime;SsubL;SsubC;hPrime1;hPrime2;deltahPrime;deltaHPrime;HBarPrime;T;SsubH;RsubT;constructor(t,e,i){const s=Math.sqrt,n=Math.pow;this.color1=t,this.color2=e,this.weights=i||{},this.ksubL=this.weights.lightness||1,this.ksubC=this.weights.chroma||1,this.ksubH=this.weights.hue||1,this.deltaLPrime=e.L-t.L,this.LBar=(t.L+e.L)/2,this.C1=s(n(t.A,2)+n(t.B,2)),this.C2=s(n(e.A,2)+n(e.B,2)),this.CBar=(this.C1+this.C2)/2,this.aPrime1=t.A+t.A/2*(1-s(n(this.CBar,7)/(n(this.CBar,7)+n(25,7)))),this.aPrime2=e.A+e.A/2*(1-s(n(this.CBar,7)/(n(this.CBar,7)+n(25,7)))),this.CPrime1=s(n(this.aPrime1,2)+n(t.B,2)),this.CPrime2=s(n(this.aPrime2,2)+n(e.B,2)),this.CBarPrime=(this.CPrime1+this.CPrime2)/2,this.deltaCPrime=this.CPrime2-this.CPrime1,this.SsubL=1+.015*n(this.LBar-50,2)/s(20+n(this.LBar-50,2)),this.SsubC=1+.045*this.CBarPrime,this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0}getDeltaE(){const t=Math.sqrt,e=Math.sin,i=Math.pow;this.hPrime1=this.gethPrime1(),this.hPrime2=this.gethPrime2(),this.deltahPrime=this.getDeltahPrime(),this.deltaHPrime=2*t(this.CPrime1*this.CPrime2)*e(this.degreesToRadians(this.deltahPrime)/2),this.HBarPrime=this.getHBarPrime(),this.T=this.getT(),this.SsubH=1+.015*this.CBarPrime*this.T,this.RsubT=this.getRsubT();const s=this.deltaLPrime/(this.ksubL*this.SsubL),n=this.deltaCPrime/(this.ksubC*this.SsubC),r=this.deltaHPrime/(this.ksubH*this.SsubH);return t(i(s,2)+i(n,2)+i(r,2)+this.RsubT*n*r)}getRsubT(){const t=Math.sin,e=Math.sqrt,i=Math.pow,s=Math.exp;return-2*e(i(this.CBarPrime,7)/(i(this.CBarPrime,7)+i(25,7)))*t(this.degreesToRadians(60*s(-i((this.HBarPrime-275)/25,2))))}getT(){const t=Math.cos;return 1-.17*t(this.degreesToRadians(this.HBarPrime-30))+.24*t(this.degreesToRadians(2*this.HBarPrime))+.32*t(this.degreesToRadians(3*this.HBarPrime+6))-.2*t(this.degreesToRadians(4*this.HBarPrime-63))}getHBarPrime(){return(0,Math.abs)(this.hPrime1-this.hPrime2)>180?(this.hPrime1+this.hPrime2+360)/2:(this.hPrime1+this.hPrime2)/2}getDeltahPrime(){const t=Math.abs;return 0===this.C1||0===this.C2?0:t(this.hPrime1-this.hPrime2)<=180?this.hPrime2-this.hPrime1:this.hPrime2<=this.hPrime1?this.hPrime2-this.hPrime1+360:this.hPrime2-this.hPrime1-360}gethPrime1(){return this._gethPrimeFn(this.color1.B,this.aPrime1)}gethPrime2(){return this._gethPrimeFn(this.color2.B,this.aPrime2)}_gethPrimeFn(t,e){let i;return 0===t&&0===e?0:(i=this.radiansToDegrees(Math.atan2(t,e)),i>=0?i:i+360)}radiansToDegrees(t){return t*(180/Math.PI)}degreesToRadians(t){return t*(Math.PI/180)}}function q(t){return t.sort(((t,e)=>z(t)[2]-z(e)[2])),t}function N(t,e){return t=I(t),e=I(e),new O({L:t[0],A:t[1],B:t[2]},{L:e[0],A:e[1],B:e[2]}).getDeltaE()}function X(t,e){const i=[],s=e.getImageData(t.x,t.y,t.width,t.height).data;for(let t=0;t<s.length;t+=4)i.push([s[t],s[t+1],s[t+2]]);return i}function j(t,e,i){let s=Array.isArray(t)?t.map((t=>X(t,i))).flat():X(t,i);s=q(s);const n=s[Math.floor(s.length/2)];return s=s.filter((t=>N(t,n)<15)),s}const F=function(t,e){let i;return function(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];clearTimeout(i),i=setTimeout((()=>{t.apply(this,s)}),300)}}((function(t){const e=function(t){if(H.rectangles.shades.length&&H.rectangles.teeth.length){const e=j(H.rectangles.teeth,0,t);return H.rectangles.shades.map((e=>j(e,0,t))).map((t=>function(t,e){t=q(t),e=q(e);const i=[],s=Math.min(t.length,e.length),n=Math.max(t.length,e.length),r=Math.floor(n/2);for(let n=-r;n<s-r;n++){const s=t[n+r]||t[t.length-1],o=e[n+r]||e[e.length-1];i.push(N(s,o))}return(o=i).reduce(((t,e)=>t+e),0)/o.length;var o}(e,t))).reduce(((t,e,i,s)=>e<s[t]?i:t),0)}return-1}(t);-1!==e&&function(t,e){let i=e.x+1,s=e.y+1;t.fillStyle="white",t.font="bold 24px Arial",t.fillText("✓",i+3,s+19),t.fillStyle="green",t.font="bold 20px Arial",t.fillText("✓",i+4,s+18),t.strokeStyle="green",t.strokeRect(e.x+2,e.y+2,e.width-4,e.height-4)}(t,H.rectangles.shades[e])}));let V="";function Y(t,e){let i=e.x,s=e.y+e.height;return t.x>=i&&t.x<=i+e.width&&t.y>=s&&t.y<=s+15}function W(t,e){return t.x>=e.x-5&&t.x<=e.x+5&&t.y>=e.y&&t.y<=e.y+e.height||t.x>=e.x+e.width-5&&t.x<=e.x+e.width+5&&t.y>=e.y&&t.y<=e.y+e.height||t.y>=e.y-5&&t.y<=e.y+5&&t.x>=e.x&&t.x<=e.x+e.width||t.y>=e.y+e.height-5&&t.y<=e.y+e.height+5&&t.x>=e.x&&t.x<=e.x+e.width}function U(t,e){return t.x>=e.x-3&&t.x<=e.x+3&&t.y>=e.y-3&&t.y<=e.y+3||t.x>=e.x+e.width/2-3&&t.x<=e.x+e.width/2+3&&t.y>=e.y-3&&t.y<=e.y+3||t.x>=e.x+e.width-3&&t.x<=e.x+e.width+3&&t.y>=e.y-3&&t.y<=e.y+3||t.x>=e.x+e.width-3&&t.x<=e.x+e.width+3&&t.y>=e.y+e.height/2-3&&t.y<=e.y+e.height/2+3||t.x>=e.x+e.width-3&&t.x<=e.x+e.width+3&&t.y>=e.y+e.height-3&&t.y<=e.y+e.height+3||t.x>=e.x+e.width/2-3&&t.x<=e.x+e.width/2+3&&t.y>=e.y+e.height-3&&t.y<=e.y+e.height+3||t.x>=e.x-3&&t.x<=e.x+3&&t.y>=e.y+e.height-3&&t.y<=e.y+e.height+3||t.x>=e.x-3&&t.x<=e.x+3&&t.y>=e.y+e.height/2-3&&t.y<=e.y+e.height/2+3}function J(t){switch(t){case"left":case"right":return"ew-resize";case"top":case"bottom":return"ns-resize";default:return"auto"}}function G(t,e){return t.x>=e.x-5&&t.x<=e.x+5?"left":t.x>=e.x+e.width-5&&t.x<=e.x+e.width+5?"right":t.y>=e.y-5&&t.y<=e.y+5?"top":t.y>=e.y+e.height-5&&t.y<=e.y+e.height+5?"bottom":""}function K(t,e){let i,s;if(e instanceof MouseEvent)i=e.clientX,s=e.clientY;else{if(!(e instanceof TouchEvent))return{x:0,y:0};i=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY}const n=t.getBoundingClientRect(),r=t.width/n.width,o=t.height/n.height;return{x:Math.round((i-n.left)*r),y:Math.round((s-n.top)*o)}}function Q(t,e,i){e.height=i.height,e.width=i.width,t.clearRect(0,0,e.width,e.height),t.drawImage(i,0,0);const s=document.getElementById("canvas-container"),n=function(t,e,i,s){const n=t/e;return n===i/s?{width:i,height:s}:s>i?{width:i,height:i/n}:{width:s*n,height:s}}(i.width,i.height,s.clientWidth,s.clientHeight);e.style.height=n.height+"px",e.style.width=n.width+"px",t.strokeStyle="red",H.rectangles.shades.forEach((e=>{t.strokeRect(e.x,e.y,e.width,e.height),et(t,e),tt(t,e)})),t.strokeStyle="blue",H.rectangles.teeth.forEach((e=>{t.strokeRect(e.x,e.y,e.width,e.height),et(t,e),tt(t,e)})),F(t)}function tt(t,e){let i=e.x,s=e.y+e.height,n=function(t){t=t.replace("#","");const e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]}(t.strokeStyle);t.fillStyle=`rgba(${n[0]},${n[1]},${n[2]},1)`,t.fillRect(i,s,e.width,15),t.fillStyle="white",t.font="bold 12px monospace",t.fillText("X",i+e.width/2-4,s+12)}function et(t,e){t.fillStyle="black",t.fillRect(e.x-3,e.y-3,6,6),t.fillRect(e.x+e.width/2-3,e.y-3,6,6),t.fillRect(e.x+e.width-3,e.y-3,6,6),t.fillRect(e.x+e.width-3,e.y+e.height/2-3,6,6),t.fillRect(e.x-3,e.y+e.height/2-3,6,6)}const it=(t,e)=>[t*e[0],t*e[1]],st=(t,e)=>[t[0]+e[0],t[1]+e[1]],nt=(t,e)=>[t[0]-e[0],t[1]-e[1]],rt=(t,e)=>t[0]*e[0]+t[1]*e[1],ot=(t,e)=>st(it(e[0],t[0]),it(e[1],t[1]));class ht{zoomMatrix;panVector;constructor(t,e){this.zoomMatrix=t,this.panVector=e}css(){const t=this.zoomMatrix,e=this.panVector;return 1===t[0][0]&&1===t[1][1]&&(e[0]=0,e[1]=0),`matrix(${t[0][0]}, ${t[0][1]}, ${t[1][0]}, ${t[1][1]}, ${e[0]}, ${e[1]})`}static average(t,e,i){return new ht(ut(t.zoomMatrix,e.zoomMatrix,i),dt(t.panVector,e.panVector,i))}}const at=(t,e)=>[[t,e],[-e,t]],lt=t=>Math.abs((t[0][0]+t[1][1])/2),ct=(t,e)=>[it(e,t[0]),it(e,t[1])],dt=(t,e,i)=>{const s=it(1-i,t),n=it(i,e);return st(s,n)},ut=(t,e,i)=>[dt(t[0],e[0],i),dt(t[1],e[1],i)];class mt{mayBeDoubleTap=null;isAnimationRunning=!1;curTouch=0;elem;elemParent;activeZoom=new ht([[1,0],[0,1]],[0,0]);resultantZoom=new ht([[1,0],[0,1]],[0,0]);srcCoords=[[0,0],[0,0]];destCoords=[[0,0],[0,0]];config;wnd;_handleZoom;_handleTouchStart;constructor(t,e,i){this.elem=t,this.elemParent=t.parentNode,this.config=this.setDefaultConfig(e,{rotate:!0,pan:!1,minZoom:0,maxZoom:1/0}),this.wnd=i||window,t.style.willChange="transform",t.style.transformOrigin="0 0",this._handleZoom=this.handleTouchEvent(this.handleZoom),this._handleTouchStart=this.handleTouchEvent(this.handleTouchStart),this.elemParent.addEventListener("touchstart",this._handleTouchStart),this.elemParent.addEventListener("touchstart",this._handleZoom),this.elemParent.addEventListener("touchmove",this._handleZoom),this.elemParent.addEventListener("touchend",this._handleZoom)}destroy(){this.elemParent.removeEventListener("touchstart",this._handleTouchStart),this.elemParent.removeEventListener("touchstart",this._handleZoom),this.elemParent.removeEventListener("touchmove",this._handleZoom),this.elemParent.removeEventListener("touchend",this._handleZoom),this.elem.style.willChange="",this.elem.style.transformOrigin="",this.elem.style.transform=""}previewZoom(){const t=lt(this.activeZoom.zoomMatrix),e=this.config.minZoom/t,i=this.config.maxZoom/t,s=((t,e,i,s,n)=>{const r=nt(t[1],t[0]),o=nt(e[1],e[0]);let h=i?((t,e)=>{const i=rt(t,t),s=rt(t,e),n=((t,e)=>t[0]*e[1]-t[1]*e[0])(t,e);return at(s/i,n/i)})(r,o):((t,e)=>{const i=Math.sqrt(rt(t,t)),s=Math.sqrt(rt(e,e));return at(s/i,0)})(r,o),a=lt(h);a<s?h=ct(h,s/a):a>n&&(h=ct(h,n/a));const l=ot(h,t[0]),c=nt(e[0],l);return new ht(h,c)})(this.srcCoords,this.destCoords,this.config.rotate,e,i);var n,r,o,h;this.resultantZoom=(n=s,r=this.activeZoom,new ht((o=n.zoomMatrix,h=r.zoomMatrix,[ot(o,h[0]),ot(o,h[1])]),st(ot(n.zoomMatrix,r.panVector),n.panVector))),this.repaint()}setZoom(t){this.resultantZoom=t,this.repaint()}finalize(){this.activeZoom=this.resultantZoom}repaint(){this.elem.style.transform=this.resultantZoom.css()}reset(){if(this.wnd.requestAnimationFrame){this.isAnimationRunning=!0;const t=this.activeZoom;let e=null;const i=s=>{e||(e=s);const n=(s-e)/100;n>=1?(this.setZoom(new ht([[1,0],[0,1]],[0,0])),this.isAnimationRunning=!1):(this.setZoom(ht.average(t,new ht([[1,0],[0,1]],[0,0]),n)),this.wnd.requestAnimationFrame(i))};this.wnd.requestAnimationFrame(i)}else this.setZoom(new ht([[1,0],[0,1]],[0,0]))}handleTouchEvent(t){return e=>{if(!(e instanceof TouchEvent))return;if(e.preventDefault(),this.isAnimationRunning)return;const i=e.touches;if(!i||i.length<2)return this.mayBeDoubleTap=null,this.isAnimationRunning=!1,this.curTouch=0,this.srcCoords=[[0,0],[0,0]],void(this.destCoords=[[0,0],[0,0]]);t(i)}}handleZoom=t=>{const e=t.length;e!==this.curTouch?(this.curTouch=e,this.finalize(),0!==e&&this.setSrcAndDest(t)):(this.setDest(t),this.previewZoom())};handleTouchStart=t=>{1===t.length&&(null!==this.mayBeDoubleTap?(this.wnd.clearTimeout(this.mayBeDoubleTap),this.reset(),this.mayBeDoubleTap=null):this.mayBeDoubleTap=this.wnd.setTimeout((()=>{this.mayBeDoubleTap=null}),300))};setSrcAndDest(t){this.srcCoords=this.getCoords(t),this.destCoords=this.srcCoords}setDest(t){this.destCoords=this.getCoords(t)}getCoordsDouble(t){const e=this.elem.parentElement.getBoundingClientRect(),i=e.left,s=e.top;return[[t[0].pageX-i,t[0].pageY-s],[t[1].pageX-i,t[1].pageY-s]]}getCoordsSingle(t){const e=this.elem.parentElement.getBoundingClientRect(),i=e.left,s=e.top,n=t[0].pageX-i,r=t[0].pageY-s;return[[n,r],[n+1,r+1]]}getCoords(t){return t.length>1?this.getCoordsDouble(t):this.getCoordsSingle(t)}setDefaultConfig(t,e){return{rotate:this.applyDefaults(t.rotate,e.rotate),pan:this.applyDefaults(t.pan,e.pan),minZoom:this.applyDefaults(t.minZoom,e.minZoom),maxZoom:this.applyDefaults(t.maxZoom,e.maxZoom)}}applyDefaults(t,e){return void 0===t?e:t}}function gt(t){let e,i,s,n,m,g,p,y,w,v,b,P,C,_,M,k,T,B,E,S,L,D,R,Z,A,H,z,I,O,q,N,X,j,F,V,Y,W,U;return{c(){var r,o;e=a("main"),i=a("section"),s=a("p"),s.textContent="This application simplifies shade selection for prosthodontic restoration\n\t\t\tusing standard phone photos. Innovative algorithms analyze images to match\n\t\t\tshades accurately. With intuitive controls, dentists identify the perfect\n\t\t\tshade for each restoration, ensuring natural results.",n=l(),m=a("button"),m.innerHTML='<img src="upload.png" alt="camera-icon" class="svelte-gdc3pr"/> <div class="svelte-gdc3pr">Choose a photo to start</div>',g=l(),p=a("input"),w=l(),v=a("section"),b=a("div"),b.innerHTML='<img id="image" src="test11.jpg" alt="img"/> <canvas id="canvas" class="svelte-gdc3pr"></canvas>',P=l(),C=a("div"),_=a("button"),M=a("img"),T=l(),B=a("div"),B.textContent="Select Shades",S=l(),L=a("button"),D=a("img"),Z=l(),A=a("div"),A.textContent="Select Teeth",z=l(),I=a("button"),I.innerHTML='<img class="ctrl-icon svelte-gdc3pr" alt="icon" src="./icon-reset.svg"/> <div class="btn-text svelte-gdc3pr">Reset</div>',q=l(),N=a("div"),N.innerHTML='<span class="svelte-gdc3pr">🛈</span> How to use',X=l(),j=a("div"),F=a("ul"),F.innerHTML="<li>Use the buttons below to start selecting teeth or shades, you can draw\n\t\t\t\t\tthe area to be selected (as teeth or shade), or you can simply tap on\n\t\t\t\t\tit and it will be automatically determined.</li> <li>Use one finger to draw and select areas, and two fingers to zoom\n\t\t\t\t\t(pinch) and pan (scroll).</li> <li>After selecting both shades and teeth the program will define the\n\t\t\t\t\tclosest shade to the selected teeth</li>",d(s,"class","svelte-gdc3pr"),d(m,"class","svelte-gdc3pr"),d(p,"accept","image/*"),d(p,"id","fileinput"),r=p,o="display",null=="none"?r.style.removeProperty(o):r.style.setProperty(o,"none",""),d(p,"type","file"),d(i,"id","upload"),d(i,"style",y="display:"+(t[0].imageSelected?"none":"block")),d(i,"class","svelte-gdc3pr"),d(b,"id","canvas-container"),d(b,"class","svelte-gdc3pr"),d(M,"class","ctrl-icon svelte-gdc3pr"),d(M,"alt","icon"),$(M.src,k="./icon-shade.svg")||d(M,"src","./icon-shade.svg"),d(B,"class","btn-text svelte-gdc3pr"),d(_,"class",E=x(("shades"===t[0].currentDraw?"selected ":"")+"ctrl-btn")+" svelte-gdc3pr"),d(D,"class","ctrl-icon svelte-gdc3pr"),d(D,"alt","icon"),$(D.src,R="./icon-tooth.svg")||d(D,"src","./icon-tooth.svg"),d(A,"class","btn-text svelte-gdc3pr"),d(L,"class",H=x(("teeth"===t[0].currentDraw?"selected ":"")+"ctrl-btn")+" svelte-gdc3pr"),d(I,"class",O=x("ctrl-btn")+" svelte-gdc3pr"),d(C,"class","ctrl svelte-gdc3pr"),d(N,"role","button"),d(N,"class","hint-button svelte-gdc3pr"),d(j,"class","hint-text svelte-gdc3pr"),d(j,"style",V="display:"+(t[0].showHint?"block":"none")),d(v,"id","process"),d(v,"style",Y="display:"+(t[0].imageSelected?"block":"none")),d(v,"class","svelte-gdc3pr"),d(e,"class","svelte-gdc3pr")},m(h,a){o(h,e,a),r(e,i),r(i,s),r(i,n),r(i,m),r(i,g),r(i,p),r(e,w),r(e,v),r(v,b),r(v,P),r(v,C),r(C,_),r(_,M),r(_,T),r(_,B),r(C,S),r(C,L),r(L,D),r(L,Z),r(L,A),r(C,z),r(C,I),r(v,q),r(v,N),r(v,X),r(v,j),r(j,F),W||(U=[c(m,"click",t[5]),c(p,"change",t[6]),c(_,"click",t[7]),c(L,"click",t[8]),c(I,"click",t[9]),c(N,"touchstart",t[10],{passive:!0}),c(j,"touchstart",t[11],{passive:!0})],W=!0)},p(t,e){let[s]=e;1&s&&y!==(y="display:"+(t[0].imageSelected?"none":"block"))&&d(i,"style",y),1&s&&E!==(E=x(("shades"===t[0].currentDraw?"selected ":"")+"ctrl-btn")+" svelte-gdc3pr")&&d(_,"class",E),1&s&&H!==(H=x(("teeth"===t[0].currentDraw?"selected ":"")+"ctrl-btn")+" svelte-gdc3pr")&&d(L,"class",H),1&s&&V!==(V="display:"+(t[0].showHint?"block":"none"))&&d(j,"style",V),1&s&&Y!==(Y="display:"+(t[0].imageSelected?"block":"none"))&&d(v,"style",Y)},i:u,o:u,d(t){t&&h(e),W=!1,f(U)}}}function ft(t,e,i){function s(t){i(0,H.currentDraw=t,H)}function n(){i(0,H.showHint=!H.showHint,H)}function r(){const t=document.getElementById("image");let e=document.getElementById("fileinput");if(!e.files)return;if(!e.files.length)return;const s=new FileReader;s.onload=function(e){e.target&&"string"==typeof e.target.result&&(t.src=e.target.result,i(0,H.imageSelected=!0,H),function(){const t=document.getElementById("image"),e=document.getElementById("canvas"),i=e.getContext("2d");i&&(function(t,e,i){let s,n,r=!1,o=!1,h=!1,a=!1,l={x:0,y:0},c=null,d=H.rectangles;function u(t){if(!(t instanceof TouchEvent))return!1;if(t.touches&&t.touches.length>1){for(var e=Date.now(),i={x:t.touches[0].clientX,y:t.touches[0].clientY},s=!0,n=1;n<t.touches.length;n++){var r=t.touches[n];if(Math.sqrt(Math.pow(r.clientX-i.x,2)+Math.pow(r.clientY-i.y,2))<10){s=!1;break}}if(s&&Date.now()-e<100)return!0}return!1}function m(){r=o=h=a=!1,c=null}const g=function(u){let m=K(e,u),g="shades";for(g in d){for(let l=d[g].length-1;l>=0;l--){let u=d[g][l];if(Y(m,u)){a=!0,r=!1,d[g].splice(l,1),Q(t,e,i);break}if(W(m,u)){h=!0,V=G(m,u),c=u;break}if(U(m,u)){h=!0,o=!0,V="corner",c=u,s=m.x-u.x,n=m.y-u.y;break}if(m.x>=u.x&&m.x<=u.x+u.width&&m.y>=u.y&&m.y<=u.y+u.height){o=!0,s=m.x-u.x,n=m.y-u.y,c=u;break}}if(h||o||a)break}h||o||a||""===H.currentDraw||(r=!0,l=m)},f=function(s){if(u(s))return m();if(r){r=!1;let n=K(e,s),o={x:Math.min(l.x,n.x),y:Math.min(l.y,n.y),width:Math.abs(l.x-n.x),height:Math.abs(l.y-n.y)};0!==o.width&&0!==o.height||(o=function(i,s){const n=t.getImageData(0,0,e.width,e.height).data,r=new Set,o=t.getImageData(i,s,1,1).data;let h=i,a=s,l=i,c=s;const d=[o[0],o[1],o[2]];let u=0;const m=[[i,s]];for(;m.length>0;){if(u++,u>8e4){h=0,l=0,a=0,c=0;break}const[t,i]=m.shift();if(t>=0&&t<e.width&&i>=0&&i<e.height&&!r.has(`${t}-${i}`)){r.add(`${t}-${i}`);const s=[[t-1,i],[t+1,i],[t,i-1],[t,i+1]];for(const t of s){const[i,s]=t;if(i>=0&&i<e.width&&s>=0&&s<e.height){const r=4*(s*e.width+i);N(d,[n[r],n[r+1],n[r+2]])<=2.8&&(m.push(t),l<t[0]&&(l=t[0]),h>t[0]&&(h=t[0]),c<t[1]&&(c=t[1]),a>t[1]&&(a=t[1]))}}}}return u<500&&(h=0,l=0,a=0,c=0),{x:h,y:a,width:l-h,height:c-a}}(l.x,l.y)),(o.width||o.height)&&""!==H.currentDraw&&H.rectangles[H.currentDraw].push(o),Q(t,e,i)}o=!1,h=!1,a=!1,c=null,V=""},p=function(a){if(u(a))return m();let g=K(e,a);if(h&&c)a.preventDefault(),"corner"===V?(c.width=g.x-c.x,c.height=g.y-c.y):function(t,e,i){switch(i){case"left":e.width+=e.x-t.x,e.x=t.x;break;case"right":e.width=t.x-e.x;break;case"top":e.height+=e.y-t.y,e.y=t.y;break;case"bottom":e.height=t.y-e.y}}(g,c,V),Q(t,e,i);else if(o&&c)a.preventDefault(),c.x=g.x-s,c.y=g.y-n,Q(t,e,i);else if(r){a.preventDefault(),Q(t,e,i);let s=g;t.strokeStyle="shades"===H.currentDraw?"red":"blue",t.strokeRect(l.x,l.y,s.x-l.x,s.y-l.y)}else{let t="crosshair",i="shades";for(i in d){for(let e=d[i].length-1;e>=0;e--){let s=d[i][e];if(Y(g,s)){t="pointer";break}if(W(g,s)){t=J(G(g,s));break}if(U(g,s)){t="nwse-resize";break}if(g.x>=s.x&&g.x<=s.x+s.width&&g.y>=s.y&&g.y<=s.y+s.height){t="move";break}}if("crosshair"!==t)break}e.style.cursor=t}};let y=0;function $(t){return function(e){e.timeStamp-y>100&&(y=e.timeStamp,t(e))}}e.addEventListener("mousedown",$(g)),e.addEventListener("touchstart",$(g)),e.addEventListener("mouseup",f),e.addEventListener("touchend",f),e.addEventListener("mousemove",p),e.addEventListener("touchmove",p)}(i,e,t),t.onload=function(){t.style.display="none",new mt(e,{rotate:!1,pan:!1,minZoom:1}),Q(i,e,t)})}())},s.readAsDataURL(e.files[0])}function o(){const t=document.getElementById("image"),e=document.getElementById("canvas"),n=e.getContext("2d");i(0,H.rectangles.shades=[],H),i(0,H.rectangles.teeth=[],H),Q(n,e,t),s("")}return[H,s,n,r,o,()=>{document.getElementById("fileinput")?.click()},t=>r(),()=>s("shades"),()=>s("teeth"),()=>o(),()=>n(),()=>n()]}new class extends A{constructor(t){super(),R(this,t,ft,gt,y,{})}}({target:document.body})})()})();